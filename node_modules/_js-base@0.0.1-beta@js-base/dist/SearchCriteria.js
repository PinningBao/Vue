var SearchOperatorRegistry_1 = require("./SearchOperatorRegistry");
var SearchCriteria = (function () {
    function SearchCriteria(fieldName, operator, rawValue, invert) {
        if (invert === void 0) { invert = false; }
        this.invert = false;
        var resolvedOperator = SearchOperatorRegistry_1.SearchOperatorRegistry.resolve(operator);
        var value = resolvedOperator.parseValue(rawValue);
        this.fieldName = fieldName;
        this.operator = resolvedOperator;
        this.value = value;
        this.invert = invert;
    }
    SearchCriteria.prototype.validate = function () {
        if (this.fieldName == null)
            throw Error("Search criteria has null field name.");
        if (this.operator == null)
            throw Error("Search criteria has null operator.");
        this.operator.validateValue(this.value);
    };
    ;
    SearchCriteria.prototype.test = function (entity) {
        var result = this.operator.exec(entity, this.fieldName, this.value);
        if (this.invert)
            result = !result;
        return result;
    };
    SearchCriteria.parse = function (key, value) {
        var match = /^(.+?)(?::(.+))?$/.exec(key);
        if (match != null) {
            var fieldName = match[1];
            var operatorName = match[2];
            return new SearchCriteria(fieldName, operatorName, value);
        }
        return null;
    };
    ;
    return SearchCriteria;
})();
exports.SearchCriteria = SearchCriteria;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlYXJjaENyaXRlcmlhLnRzIl0sIm5hbWVzIjpbIlNlYXJjaENyaXRlcmlhIiwiU2VhcmNoQ3JpdGVyaWEuY29uc3RydWN0b3IiLCJTZWFyY2hDcml0ZXJpYS52YWxpZGF0ZSIsIlNlYXJjaENyaXRlcmlhLnRlc3QiLCJTZWFyY2hDcml0ZXJpYS5wYXJzZSJdLCJtYXBwaW5ncyI6IkFBQ0EsdUNBQXFDLDBCQUEwQixDQUFDLENBQUE7QUFFaEU7SUFNSUEsd0JBQVlBLFNBQWlCQSxFQUFFQSxRQUErQkEsRUFBRUEsUUFBY0EsRUFBRUEsTUFBdUJBO1FBQXZCQyxzQkFBdUJBLEdBQXZCQSxjQUF1QkE7UUFGaEdBLFdBQU1BLEdBQUdBLEtBQUtBLENBQUNBO1FBR2xCQSxJQUFJQSxnQkFBZ0JBLEdBQUdBLCtDQUFzQkEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDaEVBLElBQUlBLEtBQUtBLEdBQUdBLGdCQUFnQkEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFFbERBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLFNBQVNBLENBQUNBO1FBQzNCQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxnQkFBZ0JBLENBQUNBO1FBQ2pDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxLQUFLQSxDQUFDQTtRQUNuQkEsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0E7SUFDekJBLENBQUNBO0lBRU1ELGlDQUFRQSxHQUFmQTtRQUNJRSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxJQUFJQSxJQUFJQSxDQUFDQTtZQUN2QkEsTUFBTUEsS0FBS0EsQ0FBQ0Esc0NBQXNDQSxDQUFDQSxDQUFDQTtRQUV4REEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsSUFBSUEsSUFBSUEsQ0FBQ0E7WUFDdEJBLE1BQU1BLEtBQUtBLENBQUNBLG9DQUFvQ0EsQ0FBQ0EsQ0FBQ0E7UUFFdERBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO0lBQzVDQSxDQUFDQTs7SUFFTUYsNkJBQUlBLEdBQVhBLFVBQVlBLE1BQWNBO1FBQ3RCRyxJQUFJQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxDQUFDQSxTQUFTQSxFQUFFQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUVwRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7WUFDWkEsTUFBTUEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0E7UUFFckJBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBO0lBQ2xCQSxDQUFDQTtJQUVhSCxvQkFBS0EsR0FBbkJBLFVBQW9CQSxHQUFXQSxFQUFFQSxLQUFVQTtRQUN2Q0ksSUFBSUEsS0FBS0EsR0FBR0EsbUJBQW1CQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUUxQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEJBLElBQUlBLFNBQVNBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ3pCQSxJQUFJQSxZQUFZQSxHQUFHQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUU1QkEsTUFBTUEsQ0FBQ0EsSUFBSUEsY0FBY0EsQ0FBQ0EsU0FBU0EsRUFBRUEsWUFBWUEsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFDOURBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO0lBQ2hCQSxDQUFDQTs7SUFDTEoscUJBQUNBO0FBQURBLENBL0NBLEFBK0NDQSxJQUFBO0FBL0NZLHNCQUFjLGlCQStDMUIsQ0FBQSIsImZpbGUiOiJTZWFyY2hDcml0ZXJpYS5qcyIsInNvdXJjZVJvb3QiOiIuLi8ifQ==
